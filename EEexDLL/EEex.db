;------------------------------------------------------
; EEex pattern database
;
; EEexLoader by mrfearless: github.com/mrfearless
; EEex by Bubb: github.com/Bubb13/EEex
;
; 
; Each section name should be unique and named to 
; represent the function or global it is for.
;
; PatBytes: is a series of bytes in text hexidecimal 
; format repesenting the pattern to match.
;
; PatAdj: is an unsigned integer representing the value
; to adjust +/- the found pattern address by, to return 
; the start of the function or the address to read a 
; game global variable from. PatAdj is optional.
;
; VerBytes: is a series of bytes in text hexidecimal 
; format repesenting the sub-pattern to check for and
; verify if the pattern found is the correct. VerBytes 
; is optional.
; 
; VerAdj: is an unsigned integer representing the value
; to adjust +/- the found pattern address by, to obtain
; an address to use for matching the VerBytes sub-
; pattern (if VerBytes is defined). VerAdj is optional.
;
; Type: is a integer value of 0 or 1. 0 represents a
; pattern defined for a function. 1 a pattern for a 
; game global variable. Type is optional
; 
;------------------------------------------------------


;------------------------------------------------------
; PatchLocation pattern
;------------------------------------------------------
[PatchLocation]
PatBytes=83C43085C075145050506AFF50FF35h
PatAdj=-5
VerBytes=83C4186A00h
VerAdj=24


;------------------------------------------------------
; Lua function patterns
;------------------------------------------------------

[_lua_createtable]
PatBytes=834608088B4D10
PatAdj=-75

[_lua_getglobal]
PatBytes=558BEC53568B7508BA02000000578B460C8B4828
PatAdj=0
VerBytes=83C0F8
VerAdj=87

[_lua_gettop]
PatBytes=558BEC8B45088B48108B40082B0183E808C1F8035DC3
PatAdj=0

[_lua_pcallk]
PatBytes=8B5514538B5D0C568B75085785D2
PatAdj=-20

[_lua_pushcclosure]
PatBytes=558BEC83E4F856578B7D1085FF751C8B55088B450C8B4A088901C7410416A5F77F834208085F5E8BE55DC3
PatAdj=0

[_lua_pushlightuserdata]
PatBytes=558BEC8B55088B450C8B4A08
PatAdj=0

[_lua_pushlstring]
PatBytes=558BEC83E4F8515356578BF98BDA8B770C837E0C007E1F807E37007407
PatAdj=0

[_lua_pushnumber]
PatBytes=558BEC8B4D08DD450C8B5108DD1A8B42042500FFFF7F3D00A5F77F74088D42088941085DC3
PatAdj=0

[_lua_pushstring]
PatBytes=558BEC83E4F856578B7D0C85FF
PatAdj=0

[_lua_rawgeti]
PatBytes=8B56088B08890A8B4004894204834608085E5DC3
PatAdj=-27
VerBytes=8B55108B08
VerAdj=-10

[_lua_rawlen]
PatBytes=8B50048BCA81E100FFFF7F81F900A5F77FB90300000075030FB6CA83E10F83E904
PatAdj=-14
VerBytes=CC55
VerAdj=-15

[_lua_setfield]
PatBytes=8B7E088BD88B55108D4F08894E08
PatAdj=-19

[_lua_setglobal]
PatBytes=558BEC53568B7508BA02000000578B460C8B4828
PatAdj=0
VerBytes=834608F0
VerAdj=103

[_lua_settable]
PatBytes=8B75088B4E088D41F8
PatAdj=-7

[_lua_settop]
PatBytes=558BEC8B45088B48108B118B4D0C85C9
PatAdj=0

[_lua_toboolean]
PatBytes=8B480481F900A5F77F741481F901A5F77F75058338007407B8010000005DC333C05DC3
PatAdj=-14

[_lua_tolstring]
PatBytes=558BEC83E4F8518B550C568B75088BCE
PatAdj=0

[_lua_tonumberx]
PatBytes=83C40485C07428DD4424088D442408DD5C240885F67406C70601000000DD005E8B4C241033CC
PatAdj=-83

[_lua_touserdata]
PatBytes=8B50048BCA81E100FFFF7F81F900A5F77FB90300000075030FB6CA83E10F83E902741083E905740433C05D
PatAdj=-14

[_lua_type]
PatBytes=8B48048BC12500FFFF7F3D00A5F77FB80300000075030FB6C183E00F5D
PatAdj=-21

[_lua_typename]
PatBytes=558BEC8B450C8B0485
PatAdj=0

[_luaL_loadstring]
PatBytes=8B550C8BC2568B7508578D78018A084084C9
PatAdj=-20


;------------------------------------------------------
; Other function patterns
;------------------------------------------------------
[__ftol2_sse]
PatBytes=742D558BEC83EC0883E4F8DD1C24F20F2C0424C9C3
PatAdj=-7

; [_GetProcAddress]
; Addreess obtained by EEex.dll once loaded

; [_LoadLibrary]
; Addreess obtained by EEex.dll once loaded

; [_SDL_free]
; Addreess obtained by EEex.dll once loaded

[__mbscmp]
PatBytes=558BEC6A00FF750CFF7508E80500000083C40C5DC3558BEC83EC108D4DF0535657FF7510
PatAdj=0

[_p_malloc]
PatBytes=558BEC568B750883FEE0776F5357
PatAdj=0


;------------------------------------------------------
; EE game function patterns
;------------------------------------------------------

;---------------------------
; CAIObjectType
;---------------------------
[CAIObjectType::Decode]
PatBytes=5356578B7D088BD9538D8D34FFFFFF89BD40FFFFFF8945E833F6C745EC0000000066C745F90000C645FB00C745F0FFFFFFFFC745F400000000C645F800
PatAdj=0

[CAIObjectType::Read]
PatBytes=8945C88BF18D45F8508D45F4508D45F0508D45EC508D45E8508D45E4508D45E0508D45DC508D45D8508D45D4508D45D050
PatAdj=-22

[CAIObjectType::Set]
PatBytes=558BEC8B55080FB642048841040FB642058841050FB642068841060FB642078841070FB642118841110FB642128841120FB642138841138B42088941088B420C89410C0FB642108841108955085D
PatAdj=0

[CAIObjectType::SetSpecialCase]
PatBytes=558BEC8B55080FB60288410C0FB6420188410D0FB6420288410E0FB6420388410F0FB642048841105DC20400
PatAdj=0

[CAIObjectType::operator==]
PatBytes=558BEC8B55088A41043A420475418A41053A420575398A41063A420675318A41073A420775298A41113A421175218A41133A421375198A41123A421275118B41083B42087509B8010000005DC2040033C05DC20400
PatAdj=0

[CAIObjectType::operator=]
PatBytes=558BEC56FF75088BF1E8
PatAdj=0
VerBytes=8BC65E5DC20400
VerAdj=14

;---------------------------
; CDerivedStats
;---------------------------
[CDerivedStats::GetAtOffset]
PatBytes=0FBF41045DC204000FBF4106
PatAdj=-26

[CDerivedStats::GetLevel]
PatBytes=558BEC518D45FC50FF750CFF7508
PatAdj=0
VerBytes=8A00
VerAdj=22

[CDerivedStats::SetLevel]
PatBytes=558BEC518D45FC50FF750CFF7508
PatAdj=0
VerBytes=0FB6C8
VerAdj=22

[CDerivedStats::GetSpellState]
PatBytes=F7D85E1BC0F7D85DC20400
PatAdj=-46

[CDerivedStats::SetSpellState]
PatBytes=81F900010000720733C05E5DC204008BC1BA01000000C1E80583E11FD3E28D0C86
PatAdj=-9

[CDerivedStats::GetWarriorLevel]
PatBytes=558BEC8B55080FB6C283C0FE83F812
PatAdj=0

[CDerivedStats::Reload]
PatBytes=8B7D088975E88B471889060FB7471E
PatAdj=-21

;---------------------------
; CGameSprite
;---------------------------
[CGameSprite::~CGameSprite]
PatBytes=8D A4 24 00 00 00 00 8B 5F 08 8B 3F 85 DB
PatAdj=-25

[CGameSprite::AddKnownSpell]
PatBytes=8D 4D C0 53 8B 5D 08 56 57 8B 7D 10 89 7D 98 89 45 BC
PatAdj=-21

[CGameSprite::AddKnownSpellMage]
PatBytes=55 8B EC 8B 55 0C 6A 01 8D 04 D5 00 00 00 00 2B C2 05 D2 01 00 00
PatAdj=0

[CGameSprite::AddKnownSpellPriest]
PatBytes=55 8B EC 8B 55 0C 6A 00 8D 04 D5 00 00 00 00 2B C2 05 A1 01 00 00
PatAdj=0

[CGameSprite::AddNewSpecialAbilities]
PatBytes=0F B6 C0 8B CB 66 2B F0 0F B7 C6 50 6A 0B
PatAdj=-92
VerBytes=C20800
VerAdj=25

[CGameSprite::GetActiveStats]
PatBytes=83 B9 48 37 00 00 00 8D 81 30 0B 00 00 75 06 8D 81 54 14 00 00 C3
PatAdj=0

[CGameSprite::GetActiveProficiency]
PatBytes=55 8B EC 8B 55 08 8D 42 A7 83 F8 2D 77 2F 83 B9 48 37 00 00 00
PatAdj=0

[CGameSprite::GetKit]
PatBytes=C1 E0 10 0B C1 C3
PatAdj=-14

[CGameSprite::GetName]
PatBytes=89 45 FC 56 8B F1 83 BE 1C 04 00 00 FF
PatAdj=-13

[CGameSprite::GetQuickButtons]
PatBytes=8DB7800A000033DB8975888B0F78B7D88895D848D4900
PatAdj=-138

[CGameSprite::MemorizeSpell]
PatBytes=8B 5D 18 89 45 E4 8B 45 0C 56 8B F1 89 45 E8
PatAdj=-20

[CGameSprite::MemorizeSpellMage]
PatBytes=8D 04 D5 00 00 00 00 2B C2 05 D2 01 00 00 8D 04 86 50
PatAdj=-68

[CGameSprite::MemorizeSpellPriest]
PatBytes=8D 04 D5 00 00 00 00 2B C2 05 A1 01 00 00 8D 04 86 50
PatAdj=-68

[CGameSprite::MemorizeSpellInnate]
PatBytes=8D 04 F5 00 00 00 00 2B C6 05 11 02 00 00 8D 04 81 50
PatAdj=-32

[CGameSprite::ReadySpell]
PatBytes=89 85 30 FF FF FF 8B 46 14 F6 40 0C 04
PatAdj=-51

[CGameSprite::RemoveKnownSpell]
PatBytes=85 F6 74 23 8B 7D 08 8B 5E 08 8D 4D F4 53
PatAdj=-28

[CGameSprite::RemoveKnownSpellMage]
PatBytes=55 8B EC 8B 45 0C 8D 14 C5 00 00 00 00 2B D0 8D 81 48 07 00 00 8D 04 90 89 45 0C 5D
PatAdj=0

[CGameSprite::RemoveKnownSpellPriest]
PatBytes=55 8B EC 8B 45 0C 8D 14 C5 00 00 00 00 2B D0 8D 81 84 06 00 00 8D 04 90 89 45 0C 5D
PatAdj=0

[CGameSprite::RemoveKnownSpellInnate]
PatBytes=55 8B EC 8B 45 0C 8D 14 C5 00 00 00 00 2B D0 8D 81 44 08 00 00 8D 04 90 89 45 0C 5D
PatAdj=0

[CGameSprite::RemoveNewSpecialAbilities]
PatBytes=0F B6 C0 8B CB 66 2B F0 0F B7 C6 50 6A 0B
PatAdj=-89
VerBytes=C20400
VerAdj=25

[CGameSprite::RenderHealthBar]
PatBytes=8B 4B 14 8B F8 8D 85 98 FE FF FF 50 8D 85 F4 FE FF FF
PatAdj=-155

[CGameSprite::SetCharacterToolTip]
PatBytes=0F B6 C0 8B CE 6A 03 89 45 D8
PatAdj=-95

[CGameSprite::SetColor]
PatBytes=8B 5D 08 56 57 8B F9 8D 43 FF 83 F8 05
PatAdj=-7

[CGameSprite::Shatter]
PatBytes=8D 55 C8 FF 76 10 B8 40 02 00 00
PatAdj=-38

[CGameSprite::UnmemorizeSpellMage]
PatBytes=8B BC 81 7C 08 00 00 8D 50 56
PatAdj=-11

[CGameSprite::UnmemorizeSpellPriest]
PatBytes=8B BC 81 60 08 00 00 8D 50 4F
PatAdj=-11

[CGameSprite::UnmemorizeSpellInnate]
PatBytes=8B BC 81 A0 08 00 00 8D 50 5F
PatAdj=-11


;---------------------------
; CInfinity
;---------------------------
[CInfinity::DrawLine]
PatBytes=DB 45 FC 89 45 18 8B 45 1C 50 0D 00 00 00 AA 8B 4D 08 D9 5D FC D9 45 FC D9 5D FC
PatAdj=-209

[CInfinity::DrawRectangle]
PatBytes=8B 4D 14 8B F8 89 4D C4 B8 56 55 55 55 8B 4D 18 C1 E1 02 F7 E9 B8 56 55 55 55 8B CA C1 E9 1F 03 CA
PatAdj=-137

[CInfinity::RenderAOE]
PatBytes=8B 46 58 2B 86 A0 00 00 00 8B 56 5C 2B 96 A4 00 00 00 03 45 E8 03 55 EC 89 45 F8 89 55 FC
PatAdj=-41


;---------------------------
; CInfGame
;---------------------------
[CInfGame::AddCharacterToAllies]
PatBytes=55 8B EC 56 8B 75 08 57 8B F9 83 FE FF 74 15
PatAdj=0
VerBytes=53
VerAdj=36

[CInfGame::AddCharacterToFamiliars]
PatBytes=55 8B EC 56 8B 75 08 57 8B F9 83 FE FF 74 15
PatAdj=0
VerBytes=61
VerAdj=36

[CInfGame::GetCharacterId]
PatBytes=55 8B EC 66 8B 45 08 66 3B 81 08 3E 00 00 7C 07 83 C8 FF
PatAdj=0

;---------------------------
; CObList
;---------------------------
[CObList::RemoveAll]
PatBytes=56 8B F1 8B 4E 14 C7 46 0C 00 00 00 00 C7 46 10 00 00 00 00 C7 46 08 00 00 00 00 C7 46 04 00 00 00 00 E8 
PatAdj=0

[CObList::RemoveHead]
PatBytes=55 8B EC 51 56 8B F1 57 8B 4E 04 8B 01 8B 79 08 89 46 04 85 C0
PatAdj=0


;---------------------------
; CResRef
;---------------------------
[CResRef::GetResRefStr]
PatBytes=56 8B 75 08 C6 45 F8 00 89 06 8D 45 F0 8B 11 8B 49 04 89 4D F4 8B CE 50 89 55 F0
PatAdj=-21

[CResRef::IsValid]
PatBytes=33 C0 38 01 0F 95 C0 C3
PatAdj=0

[CResRef::~CResRef]
PatBytes=33 C0 89 01 89 41 04 8B C1 C3
PatAdj=0

[CResRef::operator=]
PatBytes=55 8B EC 51 8B 45 0C 53 56 8B D9 33 C9 8B 30 8B 46 F8 89 0B 89 45 0C 89 4B 04 85 C0 7E 72
PatAdj=0


[CResRef::operator!=]
PatBytes=55 8B EC 56 57 8B 7D 08 33 F6 2B F9 8D 64 24 00 8A 04 0F 3C 61 7C 0C 3C 7A 7F 08 0F BE C0 83 E8 20 EB 03 0F BE C0 8A 11 80 FA 61 72 0D 80 FA 7A 77 08 0F B6 D2 83 EA 20 EB 03 0F B6 D2 3B C2 75 13
PatAdj=0


;---------------------------
; CString
;---------------------------
[(CString)_operator+]
PatBytes=2B F1 8B 45 0C 8B 00 89 45 10 8B 40 F8 89 45 08 03 C6
PatAdj=-39

[CString::~CString]
PatBytes=56 8B F1 8B 0E 8D 41 F4 3B 05 
PatAdj=0

[CStringList::FindIndex]
PatBytes=55 8B EC 8B 55 08 3B 51 0C 7D 12 85 D2 78 0E 8B 41 04 74 0B 8B 00 4A 75 FB 5D C2 04 00 33 C0 5D C2 04 00
PatAdj=0


;---------------------------
; CInfButtonArray
;---------------------------
[CInfButtonArray::SetState]
PatBytes=8B 87 74 14 00 00 89 87 78 14 00 00 C7 87 74 14 00 00 6E 00 00 00
PatAdj=-127

[CInfButtonArray::UpdateButtons]
PatBytes=33 F6 33 DB 89 85 D4 FD FF FF C7 85 E0 FD FF FF 01 00 00 00 89 B5 E4 FD FF FF 89 85 F0 FD FF FF 89 9D EC FD FF FF
PatAdj=-51

[CInfButtonArray::SetTooltip]
PatBytes=558BEC83EC0C83B97414000000
PatAdj=0


;---------------------------
; CGameEffect
;---------------------------
[CGameEffect::CGameEffect]
PatBytes=8B F1 57 8B 7D 08 8D 4E 04
PatAdj=-17

[CGameEffect::CopyFromBase]
PatBytes=8B 5D 08 8D 45 F4
PatAdj=-17

[CGameEffect::FireSpell]
PatBytes=89 4D B4 89 5D A8 89 45 A4 56 8B 75 08 85 DB
PatAdj=-31

[CGameEffect::GetItemEffect]
PatBytes=8B F0 83 C4 04 33 C0 8D 4E 14
PatAdj=-14


;---------------------------
; Misc EE functions
;---------------------------
[CGameObjectArray::GetShare]
PatBytes=C7 02 00 00 00 00 83 F8 FF 74 40 8B C8 C1 F9 10 81 E1 FF 7F 00 00
PatAdj=-7

[CGameAIBase::FireSpellPoint]
PatBytes=89 45 FC 8B 45 08 53 56 8B 75 18 8B D9 89 45 F0 8B 45 0C 57 89 45 A4 8B 45 14 6A 0C 89 5D B8 89 45 B0 89 75 AC
PatAdj=-16

[dimmGetResObject]
PatBytes=55 8B EC 83 EC 44 56 57 8D 4D BC
PatAdj=0

[CAIActionDecode]
PatBytes=55 8B EC 56 8B 75 08 57 8B F9 56 8D 4F 04
PatAdj=0

[CPtrList::RemoveAt]
PatBytes=55 8B EC 8B 55 08 56 8B F1 8B 02 3B 56 04 75 05 89 46 04 EB 05 8B 4A 04
PatAdj=0

[CRuleTables::MapCharacterSpecializationToSchool]
PatBytes=55 8B EC 8B 45 08 0F B7 C0 3D 00 04 00 00 7F 43 74 3B 3D 80 00 00 00
PatAdj=0

[operator_new]
PatBytes=69 48 14 FD 43 03 00 81 C1 C3 9E 26 00 89 48 14 C1 E9 10 81 E1 FF 7F 00 00 8B C1 C3
PatAdj=-123

[CAIScript::CAIScript]
PatBytes=8B 45 08 8B CB 89 45 F4 8B 45 0C 89 45 F8 8D 45 F4 50 8D 45 EC
PatAdj=-37


;------------------------------------------------------
; EE game global patterns
;------------------------------------------------------
[_g_lua]
PatBytes=83C43085C075145050506AFF50FF35h
PatAdj=-9
VerBytes=83C4186A00h
VerAdj=24
Type=1

[g_pChitin]
PatBytes=98 69 D8 98 00 00 00 6A 14 03 1D
PatAdj=11
Type=1

[g_pBaldurChitin]
PatBytes=66 83 F8 FF 0F 84 B6 00 00 00 A1
PatAdj=34
Type=1

[g_backgroundMenu]
PatBytes=8B F0 83 C4 14 85 F6 74 2A 6A 00 68 FF FF FF 7F 6A 00
PatAdj=-23
Type=1

[g_overlayMenu]
PatBytes=85 C0 74 04 8B 40 10 C3 33 C0 C3
PatAdj=-4
Type=1

[CChitin::TIMER_UPDATES_PER_SECOND]
PatBytes=5F 5E 83 F8 0A 72 05 83 F8 5A 76 0A C7 05
PatAdj=14
Type=1

[aB_1]
PatBytes=83 C4 08 5D C3 57 8B 7D 0C 85 FF 75 15
PatAdj=14
Type=1

[CGameSprite_vftable]
PatBytes=55 8B EC 51 53 56 8B F1 57 8B BE 48 33 00 00 C7 06 
PatAdj=17
Type=1

[CAIObjectTypeANYONE]
PatBytes=8D 81 14 01 00 00 E9 27 FF FF FF
PatAdj=21
Type=1

[VersionString_Push]
PatBytes=56 8B 75 08 89 06 FF 35
PatAdj=31
VerBytes=83C4188BC65E5DC3
VerAdj=41
Type=1






















